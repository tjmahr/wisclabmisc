<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analysis code: 'Speech development between 30 and 119 months in typical  children III: Interaction between speaking rate and intelligibility'
 • wisclabmisc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis code: 'Speech development between 30 and 119 months in typical  children III: Interaction between speaking rate and intelligibility'
">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">wisclabmisc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/gamlss-tools.html">Tools for GAMLSS models</a></li>
    <li><a class="dropdown-item" href="../articles/roc.html">Tools for ROC curves</a></li>
    <li><a class="dropdown-item" href="../articles/utterance-length-imputation.html">Utterance length imputation and weighting</a></li>
    <li><a class="dropdown-item" href="../articles/brms.html">A Workflow for brms</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tjmahr/wisclabmisc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Analysis code: 'Speech development between 30 and 119 months in typical  children III: Interaction between speaking rate and intelligibility'
</h1>
                        <h4 data-toc-skip class="author">Tristan
Mahr</h4>
            
            <h4 data-toc-skip class="date">2024-05-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tjmahr/wisclabmisc/blob/main/vignettes/articles/sm-2025-mahr-intel-rate.Rmd" class="external-link"><code>vignettes/articles/sm-2025-mahr-intel-rate.Rmd</code></a></small>
      <div class="d-none name"><code>sm-2025-mahr-intel-rate.Rmd</code></div>
    </div>

    
    
<p>The following is a reproduction of the Supplemental Material
(analysis code) for Mahr, Rathouz, &amp; Hustad (2025). All code is in
the R programming language.</p>
<ul>
<li>Publication DOI: <a href="https://doi.org/10.1044/2024_JSLHR-24-00356" class="external-link">10.1044/2024_JSLHR-24-00356</a>
</li>
<li>Supplemental Material DOI: <a href="https://doi.org/10.23641/asha.27964125.v2" class="external-link">10.23641/asha.27964125.v2</a>
</li>
<li>Analysis notes: Bayesian mixed effects regression; marginal means;
brms; Mundlak device</li>
</ul>
<hr>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>The first set of analyses considered each child’s mean speaking rate
and intelligibility for each utterance length.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">data_model</span> <span class="op">&lt;-</span> <span class="fu">targets</span><span class="fu">::</span><span class="fu">tar_read</span><span class="op">(</span><span class="st">"data_model_anon"</span><span class="op">)</span></span>
<span><span class="va">data_model</span></span>
<span><span class="co">#&gt; # A tibble: 2,196 × 14</span></span>
<span><span class="co">#&gt;    child speaking_sps artic_sps age_months tocs_level length_longest age_bin</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 c464          2.71      2.71         30          3              4      36</span></span>
<span><span class="co">#&gt;  2 c464          2.55      2.62         30          4              4      36</span></span>
<span><span class="co">#&gt;  3 c017          2.04      2.08         30          3              3      36</span></span>
<span><span class="co">#&gt;  4 c315          2.03      2.20         30          3              3      36</span></span>
<span><span class="co">#&gt;  5 c468          1.87      1.90         30          3              3      36</span></span>
<span><span class="co">#&gt;  6 c154          2.25      2.41         30          3              3      36</span></span>
<span><span class="co">#&gt;  7 c338          2.59      2.69         31          3              3      36</span></span>
<span><span class="co">#&gt;  8 c110          2.69      2.79         31          3              4      36</span></span>
<span><span class="co">#&gt;  9 c110          2.66      2.74         31          4              4      36</span></span>
<span><span class="co">#&gt; 10 c431          3.30      3.30         31          3              3      36</span></span>
<span><span class="co">#&gt; # ℹ 2,186 more rows</span></span>
<span><span class="co">#&gt; # ℹ 7 more variables: intelligibility &lt;dbl&gt;, mwi &lt;dbl&gt;, speaking_sps_3 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   artic_sps_3 &lt;dbl&gt;, age_48 &lt;dbl&gt;, tocs_length &lt;fct&gt;, tocs_level_3 &lt;dbl&gt;</span></span></code></pre></div>
<p>where</p>
<ul>
<li>
<code>child</code>: child identifier</li>
<li>
<code>speaking_sps</code>, <code>artic_sps</code>,
<code>speaking_sps_3</code>, <code>artic_sps_3</code>: speaking rate and
articulation rate in syllables per second. The <code>_3</code> versions
have 3 subtracted so that the values are centered at 3 sps.</li>
<li>
<code>age_months</code>, <code>age_bin</code>, <code>age_48</code>:
child age in months, rough age group of child (for plotting), age in
months minus 48 (so that the values are centered at 48 months)</li>
<li>
<code>tocs_level</code>, <code>tocs_length</code>,
<code>tocs_level_3</code>: utterance length as a number, factor, number
centered at 3 word.</li>
<li>
<code>length_longest</code>: the longest utterance reached by the
child.</li>
<li>
<code>intelligibility</code>, <code>mwi</code>: observed
intelligibility and intelligibility compressed into the range .001–.999
for beta regression.</li>
</ul>
</div>
<div class="section level2">
<h2 id="correlations">Correlations<a class="anchor" aria-label="anchor" href="#correlations"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_for_cors</span> <span class="op">&lt;-</span> <span class="va">data_model</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">tocs_length</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># age-residualized</span></span>
<span>    r_intel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">intelligibility</span> <span class="op">~</span> <span class="fu">splines</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_months</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    r_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">speaking_sps_3</span> <span class="op">~</span> <span class="fu">splines</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_months</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_for_cors</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">tocs_length</span>, <span class="va">age_months</span>, <span class="va">intelligibility</span>, <span class="va">speaking_sps</span>, <span class="va">r_intel</span>, <span class="va">r_rate</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">tocs_length</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pick.html" class="external-link">pick</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">Hmisc</span><span class="fu">::</span><span class="fu">rcorr</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    p.value <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_pvalue.html" class="external-link">label_pvalue</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="va">p.value</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"rllrrr"</span><span class="op">)</span></span></code></pre></div>
<table style="width:98%;" class="table">
<colgroup>
<col width="15%">
<col width="20%">
<col width="20%">
<col width="13%">
<col width="13%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="left">tocs_length</th>
<th align="left">column1</th>
<th align="left">column2</th>
<th align="left">estimate</th>
<th align="left">n</th>
<th align="left">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">3</td>
<td align="left">intelligibility</td>
<td align="left">age_months</td>
<td align="left">0.688</td>
<td align="left">538</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">speaking_sps</td>
<td align="left">age_months</td>
<td align="left">0.330</td>
<td align="left">538</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">speaking_sps</td>
<td align="left">intelligibility</td>
<td align="left">0.216</td>
<td align="left">538</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">r_intel</td>
<td align="left">age_months</td>
<td align="left">0.000</td>
<td align="left">538</td>
<td align="left">&gt;0.999</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">r_intel</td>
<td align="left">intelligibility</td>
<td align="left">0.571</td>
<td align="left">538</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">r_intel</td>
<td align="left">speaking_sps</td>
<td align="left">-0.069</td>
<td align="left">538</td>
<td align="left">0.107</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">r_rate</td>
<td align="left">age_months</td>
<td align="left">0.000</td>
<td align="left">538</td>
<td align="left">&gt;0.999</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">r_rate</td>
<td align="left">intelligibility</td>
<td align="left">-0.042</td>
<td align="left">538</td>
<td align="left">0.329</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">r_rate</td>
<td align="left">speaking_sps</td>
<td align="left">0.942</td>
<td align="left">538</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">r_rate</td>
<td align="left">r_intel</td>
<td align="left">-0.074</td>
<td align="left">538</td>
<td align="left">0.087</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">intelligibility</td>
<td align="left">age_months</td>
<td align="left">0.655</td>
<td align="left">478</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">speaking_sps</td>
<td align="left">age_months</td>
<td align="left">0.440</td>
<td align="left">478</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">speaking_sps</td>
<td align="left">intelligibility</td>
<td align="left">0.281</td>
<td align="left">478</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">r_intel</td>
<td align="left">age_months</td>
<td align="left">0.000</td>
<td align="left">478</td>
<td align="left">&gt;0.999</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">r_intel</td>
<td align="left">intelligibility</td>
<td align="left">0.653</td>
<td align="left">478</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">r_intel</td>
<td align="left">speaking_sps</td>
<td align="left">-0.071</td>
<td align="left">478</td>
<td align="left">0.120</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">r_rate</td>
<td align="left">age_months</td>
<td align="left">0.000</td>
<td align="left">478</td>
<td align="left">&gt;0.999</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">r_rate</td>
<td align="left">intelligibility</td>
<td align="left">-0.052</td>
<td align="left">478</td>
<td align="left">0.255</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">r_rate</td>
<td align="left">speaking_sps</td>
<td align="left">0.891</td>
<td align="left">478</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">r_rate</td>
<td align="left">r_intel</td>
<td align="left">-0.080</td>
<td align="left">478</td>
<td align="left">0.081</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">intelligibility</td>
<td align="left">age_months</td>
<td align="left">0.566</td>
<td align="left">422</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">speaking_sps</td>
<td align="left">age_months</td>
<td align="left">0.438</td>
<td align="left">422</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">speaking_sps</td>
<td align="left">intelligibility</td>
<td align="left">0.176</td>
<td align="left">422</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">r_intel</td>
<td align="left">age_months</td>
<td align="left">0.000</td>
<td align="left">422</td>
<td align="left">&gt;0.999</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">r_intel</td>
<td align="left">intelligibility</td>
<td align="left">0.768</td>
<td align="left">422</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">r_intel</td>
<td align="left">speaking_sps</td>
<td align="left">-0.126</td>
<td align="left">422</td>
<td align="left">0.010</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">r_rate</td>
<td align="left">age_months</td>
<td align="left">0.000</td>
<td align="left">422</td>
<td align="left">&gt;0.999</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">r_rate</td>
<td align="left">intelligibility</td>
<td align="left">-0.108</td>
<td align="left">422</td>
<td align="left">0.027</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">r_rate</td>
<td align="left">speaking_sps</td>
<td align="left">0.894</td>
<td align="left">422</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">r_rate</td>
<td align="left">r_intel</td>
<td align="left">-0.141</td>
<td align="left">422</td>
<td align="left">0.004</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="left">intelligibility</td>
<td align="left">age_months</td>
<td align="left">0.514</td>
<td align="left">386</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">speaking_sps</td>
<td align="left">age_months</td>
<td align="left">0.466</td>
<td align="left">386</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="left">speaking_sps</td>
<td align="left">intelligibility</td>
<td align="left">0.230</td>
<td align="left">386</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">r_intel</td>
<td align="left">age_months</td>
<td align="left">0.000</td>
<td align="left">386</td>
<td align="left">&gt;0.999</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="left">r_intel</td>
<td align="left">intelligibility</td>
<td align="left">0.826</td>
<td align="left">386</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">r_intel</td>
<td align="left">speaking_sps</td>
<td align="left">-0.026</td>
<td align="left">386</td>
<td align="left">0.616</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="left">r_rate</td>
<td align="left">age_months</td>
<td align="left">0.000</td>
<td align="left">386</td>
<td align="left">&gt;0.999</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">r_rate</td>
<td align="left">intelligibility</td>
<td align="left">-0.024</td>
<td align="left">386</td>
<td align="left">0.639</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="left">r_rate</td>
<td align="left">speaking_sps</td>
<td align="left">0.883</td>
<td align="left">386</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">r_rate</td>
<td align="left">r_intel</td>
<td align="left">-0.029</td>
<td align="left">386</td>
<td align="left">0.570</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">intelligibility</td>
<td align="left">age_months</td>
<td align="left">0.525</td>
<td align="left">372</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">speaking_sps</td>
<td align="left">age_months</td>
<td align="left">0.508</td>
<td align="left">372</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">speaking_sps</td>
<td align="left">intelligibility</td>
<td align="left">0.214</td>
<td align="left">372</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">r_intel</td>
<td align="left">age_months</td>
<td align="left">0.000</td>
<td align="left">372</td>
<td align="left">&gt;0.999</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">r_intel</td>
<td align="left">intelligibility</td>
<td align="left">0.829</td>
<td align="left">372</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">r_intel</td>
<td align="left">speaking_sps</td>
<td align="left">-0.082</td>
<td align="left">372</td>
<td align="left">0.113</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">r_rate</td>
<td align="left">age_months</td>
<td align="left">0.000</td>
<td align="left">372</td>
<td align="left">&gt;0.999</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">r_rate</td>
<td align="left">intelligibility</td>
<td align="left">-0.080</td>
<td align="left">372</td>
<td align="left">0.125</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">r_rate</td>
<td align="left">speaking_sps</td>
<td align="left">0.857</td>
<td align="left">372</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">r_rate</td>
<td align="left">r_intel</td>
<td align="left">-0.096</td>
<td align="left">372</td>
<td align="left">0.064</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="beta-regression-model">Beta regression model<a class="anchor" aria-label="anchor" href="#beta-regression-model"></a>
</h2>
<blockquote>
<p>Analyses were carried in the R programming language (vers. 4.4.0, R
Core Team, 2024). HMC sampling was performed using Stan (vers. 2.34.1,
Stan Development Team, 2024) through the brms R package (vers. 2.21.0,
Bürkner, 2017) and the cmdstanr backend (vers. 0.7.1, Gabry, Češnovar,
&amp; Johnson, 2024). We compared models with approximate leave-one-out
cross validation with the loo R package (vers. 2.7.0, Vehtari, Gelman,
&amp; Gabry, 2017).</p>
</blockquote>
<p>I wrote a custom function for fitting beta regression models. A user
passes in the data and a <code>flavor</code> which flavor determines
which model formula to use. Models were seeded using dates
(<code>seed</code>) for reproducibility.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">splines</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms" class="external-link">brms</a></span><span class="op">)</span></span>
<span><span class="va">fit_beta_model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">flavor</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">priors</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">formula</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">file</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">seed</span> <span class="op">=</span> <span class="fl">20221013</span>,</span>
<span>  <span class="va">adapt_delta</span> <span class="op">=</span> <span class="fl">.8</span>,</span>
<span>  <span class="va">iter</span> <span class="op">=</span> <span class="fl">2000</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    ri_main_interaction <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>      <span class="va">mwi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">25</span><span class="op">)</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="va">tocs_length</span> <span class="op">+</span></span>
<span>        <span class="va">speaking_sps_3</span> <span class="op">+</span></span>
<span>        <span class="va">speaking_sps_3</span><span class="op">:</span><span class="va">tocs_length</span> <span class="op">+</span></span>
<span>        <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">child</span><span class="op">)</span>,</span>
<span>      <span class="va">phi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fl">17</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">Beta</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    ri_no_main_length <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>      <span class="va">mwi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">25</span><span class="op">)</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="va">speaking_sps</span> <span class="op">+</span></span>
<span>        <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">child</span><span class="op">)</span>,</span>
<span>      <span class="va">phi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fl">17</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">Beta</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    ri_no_main_interaction <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>      <span class="va">mwi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">25</span><span class="op">)</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="va">tocs_length</span> <span class="op">+</span></span>
<span>        <span class="va">speaking_sps_3</span> <span class="op">+</span></span>
<span>        <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">child</span><span class="op">)</span>,</span>
<span>      <span class="va">phi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fl">17</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">Beta</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    rs_for_rate <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>      <span class="va">mwi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">25</span><span class="op">)</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="va">tocs_length</span> <span class="op">+</span></span>
<span>        <span class="va">speaking_sps_3</span> <span class="op">+</span></span>
<span>        <span class="va">speaking_sps_3</span><span class="op">:</span><span class="va">tocs_length</span> <span class="op">+</span></span>
<span>        <span class="op">(</span><span class="va">speaking_sps_3</span> <span class="op">|</span> <span class="va">child</span><span class="op">)</span>,</span>
<span>      <span class="va">phi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fl">17</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">Beta</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    rs_monotonic_length <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>      <span class="va">mwi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">25</span><span class="op">)</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://paulbuerkner.com/brms/reference/mo.html" class="external-link">mo</a></span><span class="op">(</span><span class="va">tocs_level</span><span class="op">)</span> <span class="op">*</span> <span class="va">speaking_sps_3</span> <span class="op">+</span></span>
<span>        <span class="op">(</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/mo.html" class="external-link">mo</a></span><span class="op">(</span><span class="va">tocs_level</span><span class="op">)</span> <span class="op">|</span> <span class="va">child</span><span class="op">)</span>,</span>
<span>      <span class="va">phi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fl">17</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">Beta</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    rs_for_length <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>      <span class="va">mwi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">25</span><span class="op">)</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="va">tocs_length</span> <span class="op">+</span></span>
<span>        <span class="va">speaking_sps_3</span> <span class="op">+</span></span>
<span>        <span class="va">speaking_sps_3</span><span class="op">:</span><span class="va">tocs_length</span> <span class="op">+</span></span>
<span>        <span class="op">(</span><span class="va">tocs_length</span> <span class="op">|</span> <span class="va">child</span><span class="op">)</span>,</span>
<span>      <span class="va">phi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fl">17</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">Beta</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    rs_for_length_plus_rate <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>      <span class="va">mwi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">25</span><span class="op">)</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="va">tocs_length</span> <span class="op">+</span></span>
<span>        <span class="va">speaking_sps_3</span> <span class="op">+</span></span>
<span>        <span class="va">speaking_sps_3</span><span class="op">:</span><span class="va">tocs_length</span> <span class="op">+</span></span>
<span>        <span class="op">(</span><span class="va">speaking_sps_3</span> <span class="op">+</span> <span class="va">tocs_length</span> <span class="op">|</span> <span class="va">child</span><span class="op">)</span>,</span>
<span>      <span class="va">phi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fl">17</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">Beta</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    rs_for_length_colon_rate <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>      <span class="va">mwi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">25</span><span class="op">)</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="va">tocs_length</span> <span class="op">+</span></span>
<span>        <span class="va">speaking_sps_3</span> <span class="op">+</span></span>
<span>        <span class="va">speaking_sps_3</span><span class="op">:</span><span class="va">tocs_length</span> <span class="op">+</span></span>
<span>        <span class="op">(</span><span class="va">speaking_sps_3</span><span class="op">:</span><span class="va">tocs_length</span> <span class="op">|</span> <span class="va">child</span><span class="op">)</span>,</span>
<span>      <span class="va">phi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fl">17</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">Beta</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    rs_for_length_colon_rate_no_intercept <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>      <span class="va">mwi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">25</span><span class="op">)</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="va">tocs_length</span> <span class="op">+</span></span>
<span>        <span class="va">speaking_sps_3</span> <span class="op">+</span></span>
<span>        <span class="va">speaking_sps_3</span><span class="op">:</span><span class="va">tocs_length</span> <span class="op">+</span></span>
<span>        <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">speaking_sps_3</span><span class="op">:</span><span class="va">tocs_length</span> <span class="op">|</span> <span class="va">child</span><span class="op">)</span>,</span>
<span>      <span class="va">phi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fl">17</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">Beta</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    rs_for_length_by_rate <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>      <span class="va">mwi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">25</span><span class="op">)</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="va">tocs_length</span> <span class="op">+</span></span>
<span>        <span class="va">speaking_sps_3</span> <span class="op">+</span></span>
<span>        <span class="va">speaking_sps_3</span><span class="op">:</span><span class="va">tocs_length</span> <span class="op">+</span></span>
<span>        <span class="op">(</span><span class="va">speaking_sps_3</span> <span class="op">*</span> <span class="va">tocs_length</span> <span class="op">|</span> <span class="va">child</span><span class="op">)</span>,</span>
<span>      <span class="va">phi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">age_48</span>, knots <span class="op">=</span> <span class="fl">17</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="fl">71</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">Beta</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    ri_main_interaction <span class="op">=</span> <span class="st">"models/ri_main_interaction"</span>,</span>
<span>    ri_no_main_length <span class="op">=</span> <span class="st">"models/ri_no_main_length"</span>,</span>
<span>    ri_no_main_interaction <span class="op">=</span> <span class="st">"models/ri_no_main_interaction"</span>,</span>
<span>    rs_for_rate <span class="op">=</span> <span class="st">"models/rs_for_rate"</span>,</span>
<span>    rs_for_length <span class="op">=</span> <span class="st">"models/rs_for_length"</span>,</span>
<span>    rs_for_length_plus_rate <span class="op">=</span> <span class="st">"models/rs_for_length_plus_rate"</span>,</span>
<span>    rs_for_length_colon_rate <span class="op">=</span> <span class="st">"models/rs_for_length_colon_rate"</span>,</span>
<span>    rs_for_length_colon_rate_no_intercept <span class="op">=</span> <span class="st">"models/rs_for_length_colon_rate_no_intercept"</span>,</span>
<span>    rs_for_length_by_rate <span class="op">=</span> <span class="st">"models/rs_for_length_by_rate"</span>,</span>
<span>    rs_monotonic_length <span class="op">=</span> <span class="st">"models/rs_monotonic_length"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">formula</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span> <span class="va">formulas</span><span class="op">[[</span><span class="va">flavor</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">file</span> <span class="op">&lt;-</span> <span class="va">file</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span> <span class="va">files</span><span class="op">[[</span><span class="va">flavor</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">priors</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 2.5)"</span>, class <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, class <span class="op">=</span> <span class="st">"sd"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">has_element</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">y</span><span class="op">)</span></span>
<span>    <span class="va">has_correlation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/default_prior.html" class="external-link">get_prior</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extract.html" class="external-link">getElement</a></span><span class="op">(</span><span class="st">"class"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://purrr.tidyverse.org/reference/has_element.html" class="external-link">has_element</a></span><span class="op">(</span><span class="st">"cor"</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">has_correlation</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="va">priors</span>,</span>
<span>        <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"lkj(2)"</span>, class <span class="op">=</span> <span class="st">"cor"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span></span>
<span>  <span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="va">formula</span>,</span>
<span>    data <span class="op">=</span> <span class="va">data</span>,</span>
<span>    prior <span class="op">=</span> <span class="va">priors</span>,</span>
<span>    backend <span class="op">=</span> <span class="st">"cmdstanr"</span>,</span>
<span>    seed <span class="op">=</span> <span class="va">seed</span>,</span>
<span>    file <span class="op">=</span> <span class="va">file</span>,</span>
<span>    file_refit <span class="op">=</span> <span class="st">"on_change"</span>,</span>
<span>    chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    iter <span class="op">=</span> <span class="va">iter</span>,</span>
<span>    save_pars <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/save_pars.html" class="external-link">save_pars</a></span><span class="op">(</span>all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="va">adapt_delta</span><span class="op">)</span>,</span>
<span>    refresh <span class="op">=</span> <span class="fl">50</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">t</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loo"</span>, <span class="st">"loo_R2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The models compared with in the manuscript were as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loo_comparison</span> <span class="op">&lt;-</span> <span class="fu">targets</span><span class="fu">::</span><span class="fu">tar_read</span><span class="op">(</span><span class="st">"loo_comparison"</span><span class="op">)</span></span>
<span><span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">model</span>, <span class="op">~</span><span class="va">random_effects</span>,</span>
<span>  <span class="st">"model_rs_length"</span>, <span class="st">"1 + length | child"</span>, </span>
<span>  <span class="st">"model_rs_rate"</span>, <span class="st">"1 + rate | child"</span>, </span>
<span>  <span class="st">"model_rs_length_plus_rate"</span>, <span class="st">"1 + length + rate | child"</span>, </span>
<span>  <span class="st">"model_main"</span>, <span class="st">"1 | child"</span>, </span>
<span>  <span class="st">"model_rs_length_colon_rate"</span>, <span class="st">"1 + length:rate | child"</span>, </span>
<span>  <span class="st">"model_rs_monotonic_length"</span>, <span class="st">"1 + monotonic-length | child"</span>, </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">loo_table_data</span> <span class="op">&lt;-</span> <span class="va">loo_comparison</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">labels</span>, by <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">loo_r2_mean</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">loo_r2_sd</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">random_effects</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">loo_table_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table style="width:99%;" class="table">
<colgroup>
<col width="17%">
<col width="11%">
<col width="7%">
<col width="6%">
<col width="6%">
<col width="8%">
<col width="4%">
<col width="6%">
<col width="4%">
<col width="6%">
<col width="8%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">model</th>
<th align="left">random_effects</th>
<th align="left">elpd_diff</th>
<th align="left">se_diff</th>
<th align="left">elpd_loo</th>
<th align="left">se_elpd_loo</th>
<th align="left">p_loo</th>
<th align="left">se_p_loo</th>
<th align="left">looic</th>
<th align="left">se_looic</th>
<th align="left">loo_r2_mean</th>
<th align="left">loo_r2_sd</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">model_rs_length</td>
<td align="left">1 + length | child</td>
<td align="left">0.0</td>
<td align="left">0.0</td>
<td align="left">3814</td>
<td align="left">49</td>
<td align="left">852</td>
<td align="left">20</td>
<td align="left">-7628</td>
<td align="left">98</td>
<td align="left">0.84</td>
<td align="left">0.009</td>
</tr>
<tr class="even">
<td align="left">model_rs_length_plus_rate</td>
<td align="left">1 + length + rate | child</td>
<td align="left">-28.8</td>
<td align="left">5.3</td>
<td align="left">3785</td>
<td align="left">50</td>
<td align="left">784</td>
<td align="left">20</td>
<td align="left">-7571</td>
<td align="left">100</td>
<td align="left">0.82</td>
<td align="left">0.010</td>
</tr>
<tr class="odd">
<td align="left">model_rs_monotonic_length</td>
<td align="left">1 + monotonic-length | child</td>
<td align="left">-98.9</td>
<td align="left">9.1</td>
<td align="left">3715</td>
<td align="left">51</td>
<td align="left">523</td>
<td align="left">16</td>
<td align="left">-7431</td>
<td align="left">102</td>
<td align="left">0.79</td>
<td align="left">0.011</td>
</tr>
<tr class="even">
<td align="left">model_rs_rate</td>
<td align="left">1 + rate | child</td>
<td align="left">-101.4</td>
<td align="left">9.8</td>
<td align="left">3713</td>
<td align="left">52</td>
<td align="left">490</td>
<td align="left">15</td>
<td align="left">-7426</td>
<td align="left">104</td>
<td align="left">0.78</td>
<td align="left">0.011</td>
</tr>
<tr class="odd">
<td align="left">model_main</td>
<td align="left">1 | child</td>
<td align="left">-107.2</td>
<td align="left">9.7</td>
<td align="left">3707</td>
<td align="left">52</td>
<td align="left">442</td>
<td align="left">15</td>
<td align="left">-7414</td>
<td align="left">104</td>
<td align="left">0.78</td>
<td align="left">0.011</td>
</tr>
<tr class="even">
<td align="left">model_rs_length_colon_rate</td>
<td align="left">1 + length:rate | child</td>
<td align="left">-107.9</td>
<td align="left">9.8</td>
<td align="left">3706</td>
<td align="left">52</td>
<td align="left">479</td>
<td align="left">15</td>
<td align="left">-7413</td>
<td align="left">104</td>
<td align="left">0.78</td>
<td align="left">0.011</td>
</tr>
</tbody>
</table>
<p>All models (except <code>model_rs_monotonic_length</code>) formula
includes a categorical effect of utterance length
<code>tocs_length</code>, speaking rate centered at 3 sps
<code>tocs_length</code>, an adjustment to the rate effect for each
length <code>speaing_sps_3:tocs_length</code>, and the 3-df spline for
age <code>ns(...)</code>. The <code>phi ~</code> regression lines allows
the dispersion of the beta distribution to change with age. What
differentiated these models were the variables used in the random
(by-child) effects. <code>model_rs_monotonic_length</code>
<code>model_rs_monotonic_length</code> model applies the method in
Bürkner &amp; Charpentier (2020), using <code><a href="https://paulbuerkner.com/brms/reference/mo.html" class="external-link">mo()</a></code> to mark a
variable as monotonic.</p>
<p>The winning model on the basis of model comparison was
<code>model_rs_length</code> (by-child length effects).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_rs_length</span> <span class="op">&lt;-</span> <span class="fu">targets</span><span class="fu">::</span><span class="fu">tar_read</span><span class="op">(</span><span class="va">model_rs_length</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_rs_length</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Family: beta </span></span>
<span><span class="co">#&gt;   Links: mu = logit; phi = log </span></span>
<span><span class="co">#&gt; Formula: mwi ~ ns(age_48, knots = c(9, 25), Boundary.knots = c(-18, 71)) + tocs_length + speaking_sps_3 + speaking_sps_3:tocs_length + (tocs_length | child) </span></span>
<span><span class="co">#&gt;          phi ~ ns(age_48, knots = 17, Boundary.knots = c(-18, 71))</span></span>
<span><span class="co">#&gt;    Data: data (Number of observations: 2196) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 3000; warmup = 1500; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 6000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multilevel Hyperparameters:</span></span>
<span><span class="co">#&gt; ~child (Number of levels: 538) </span></span>
<span><span class="co">#&gt;                                Estimate Est.Error l-95% CI u-95% CI Rhat</span></span>
<span><span class="co">#&gt; sd(Intercept)                      0.80      0.04     0.71     0.88 1.01</span></span>
<span><span class="co">#&gt; sd(tocs_length4)                   0.50      0.09     0.28     0.65 1.02</span></span>
<span><span class="co">#&gt; sd(tocs_length5)                   0.38      0.11     0.11     0.55 1.02</span></span>
<span><span class="co">#&gt; sd(tocs_length6)                   0.44      0.09     0.22     0.59 1.02</span></span>
<span><span class="co">#&gt; sd(tocs_length7)                   0.54      0.09     0.34     0.68 1.02</span></span>
<span><span class="co">#&gt; cor(Intercept,tocs_length4)       -0.27      0.10    -0.43    -0.02 1.01</span></span>
<span><span class="co">#&gt; cor(Intercept,tocs_length5)       -0.45      0.10    -0.62    -0.23 1.00</span></span>
<span><span class="co">#&gt; cor(tocs_length4,tocs_length5)     0.41      0.18    -0.08     0.66 1.01</span></span>
<span><span class="co">#&gt; cor(Intercept,tocs_length6)       -0.31      0.13    -0.49    -0.01 1.00</span></span>
<span><span class="co">#&gt; cor(tocs_length4,tocs_length6)     0.57      0.13     0.26     0.77 1.00</span></span>
<span><span class="co">#&gt; cor(tocs_length5,tocs_length6)     0.53      0.19     0.01     0.77 1.01</span></span>
<span><span class="co">#&gt; cor(Intercept,tocs_length7)       -0.26      0.12    -0.44     0.03 1.01</span></span>
<span><span class="co">#&gt; cor(tocs_length4,tocs_length7)     0.54      0.12     0.25     0.73 1.00</span></span>
<span><span class="co">#&gt; cor(tocs_length5,tocs_length7)     0.45      0.18    -0.03     0.70 1.01</span></span>
<span><span class="co">#&gt; cor(tocs_length6,tocs_length7)     0.86      0.10     0.67     0.96 1.01</span></span>
<span><span class="co">#&gt;                                Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; sd(Intercept)                       191      280</span></span>
<span><span class="co">#&gt; sd(tocs_length4)                    120      163</span></span>
<span><span class="co">#&gt; sd(tocs_length5)                    125      181</span></span>
<span><span class="co">#&gt; sd(tocs_length6)                    136      160</span></span>
<span><span class="co">#&gt; sd(tocs_length7)                    144      163</span></span>
<span><span class="co">#&gt; cor(Intercept,tocs_length4)         290      306</span></span>
<span><span class="co">#&gt; cor(Intercept,tocs_length5)        2818      915</span></span>
<span><span class="co">#&gt; cor(tocs_length4,tocs_length5)      369      270</span></span>
<span><span class="co">#&gt; cor(Intercept,tocs_length6)         380      273</span></span>
<span><span class="co">#&gt; cor(tocs_length4,tocs_length6)      662      480</span></span>
<span><span class="co">#&gt; cor(tocs_length5,tocs_length6)      423      248</span></span>
<span><span class="co">#&gt; cor(Intercept,tocs_length7)         232      239</span></span>
<span><span class="co">#&gt; cor(tocs_length4,tocs_length7)      718      463</span></span>
<span><span class="co">#&gt; cor(tocs_length5,tocs_length7)      384      241</span></span>
<span><span class="co">#&gt; cor(tocs_length6,tocs_length7)      567      280</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;                                              Estimate Est.Error l-95% CI</span></span>
<span><span class="co">#&gt; Intercept                                       -0.42      0.11    -0.64</span></span>
<span><span class="co">#&gt; phi_Intercept                                    3.82      0.39     3.08</span></span>
<span><span class="co">#&gt; nsage_48knotsEQc925Boundary.knotsEQcM18711       3.25      0.15     2.95</span></span>
<span><span class="co">#&gt; nsage_48knotsEQc925Boundary.knotsEQcM18712       6.80      0.28     6.26</span></span>
<span><span class="co">#&gt; nsage_48knotsEQc925Boundary.knotsEQcM18713       3.63      0.21     3.22</span></span>
<span><span class="co">#&gt; tocs_length4                                    -0.10      0.05    -0.20</span></span>
<span><span class="co">#&gt; tocs_length5                                    -0.31      0.05    -0.41</span></span>
<span><span class="co">#&gt; tocs_length6                                    -0.17      0.06    -0.28</span></span>
<span><span class="co">#&gt; tocs_length7                                    -0.51      0.06    -0.63</span></span>
<span><span class="co">#&gt; speaking_sps_3                                  -0.08      0.11    -0.31</span></span>
<span><span class="co">#&gt; tocs_length4:speaking_sps_3                     -0.05      0.13    -0.30</span></span>
<span><span class="co">#&gt; tocs_length5:speaking_sps_3                     -0.45      0.12    -0.69</span></span>
<span><span class="co">#&gt; tocs_length6:speaking_sps_3                     -0.25      0.13    -0.51</span></span>
<span><span class="co">#&gt; tocs_length7:speaking_sps_3                     -0.34      0.13    -0.59</span></span>
<span><span class="co">#&gt; phi_nsage_48knotsEQ17Boundary.knotsEQcM18711     0.13      0.67    -1.22</span></span>
<span><span class="co">#&gt; phi_nsage_48knotsEQ17Boundary.knotsEQcM18712     0.53      0.23     0.07</span></span>
<span><span class="co">#&gt;                                              u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept                                       -0.19 1.00     2038     3248</span></span>
<span><span class="co">#&gt; phi_Intercept                                    4.59 1.02      118      212</span></span>
<span><span class="co">#&gt; nsage_48knotsEQc925Boundary.knotsEQcM18711       3.55 1.00     2596     3175</span></span>
<span><span class="co">#&gt; nsage_48knotsEQc925Boundary.knotsEQcM18712       7.35 1.00     1873     3560</span></span>
<span><span class="co">#&gt; nsage_48knotsEQc925Boundary.knotsEQcM18713       4.03 1.00     3657     3703</span></span>
<span><span class="co">#&gt; tocs_length4                                    -0.01 1.00     3297     3803</span></span>
<span><span class="co">#&gt; tocs_length5                                    -0.22 1.00     3023     4015</span></span>
<span><span class="co">#&gt; tocs_length6                                    -0.06 1.00     3206     4399</span></span>
<span><span class="co">#&gt; tocs_length7                                    -0.41 1.00     2993     3682</span></span>
<span><span class="co">#&gt; speaking_sps_3                                   0.14 1.00     1971     2564</span></span>
<span><span class="co">#&gt; tocs_length4:speaking_sps_3                      0.21 1.00     3431     4386</span></span>
<span><span class="co">#&gt; tocs_length5:speaking_sps_3                     -0.21 1.00     3030     4074</span></span>
<span><span class="co">#&gt; tocs_length6:speaking_sps_3                      0.01 1.00     3197     3824</span></span>
<span><span class="co">#&gt; tocs_length7:speaking_sps_3                     -0.08 1.00     2527     3713</span></span>
<span><span class="co">#&gt; phi_nsage_48knotsEQ17Boundary.knotsEQcM18711     1.33 1.02      140      352</span></span>
<span><span class="co">#&gt; phi_nsage_48knotsEQ17Boundary.knotsEQcM18712     0.97 1.01      290      843</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
<p>However, it bears noting that a more appropriate model comparison
would compare them using leave-one-child-out cross-validation. This
approach was computational prohibitive because it would require fitting
538 versions of each model.</p>
<div class="section level3">
<h3 id="marginal-means">Marginal means<a class="anchor" aria-label="anchor" href="#marginal-means"></a>
</h3>
<p>With a model in hand, we compute marginal predictions by simulating
new children from each posterior sample. The basic recipe is as
follows.</p>
<p>Create a grid of data to make predictions for, giving
<code>child</code> an out-of-sample value. To make things easier, I
break the data into batches in a list.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing</a></span><span class="op">(</span></span>
<span>  age_48 <span class="op">=</span> <span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span> <span class="op">*</span> <span class="fl">12</span> <span class="op">-</span> <span class="fl">48</span>,</span>
<span>  tocs_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>, <span class="st">"7"</span><span class="op">)</span>,</span>
<span>  speaking_sps_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.5</span><span class="op">)</span>,</span>
<span>  child <span class="op">=</span> <span class="st">"fake"</span></span>
<span><span class="op">)</span> </span>
<span><span class="va">newdata</span></span>
<span><span class="co">#&gt; # A tibble: 50 × 4</span></span>
<span><span class="co">#&gt;    age_48 tocs_length speaking_sps_3 child</span></span>
<span><span class="co">#&gt;     &lt;dbl&gt; &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt;  1    -12 3                      0   fake </span></span>
<span><span class="co">#&gt;  2    -12 3                      0.5 fake </span></span>
<span><span class="co">#&gt;  3    -12 4                      0   fake </span></span>
<span><span class="co">#&gt;  4    -12 4                      0.5 fake </span></span>
<span><span class="co">#&gt;  5    -12 5                      0   fake </span></span>
<span><span class="co">#&gt;  6    -12 5                      0.5 fake </span></span>
<span><span class="co">#&gt;  7    -12 6                      0   fake </span></span>
<span><span class="co">#&gt;  8    -12 6                      0.5 fake </span></span>
<span><span class="co">#&gt;  9    -12 7                      0   fake </span></span>
<span><span class="co">#&gt; 10    -12 7                      0.5 fake </span></span>
<span><span class="co">#&gt; # ℹ 40 more rows</span></span>
<span></span>
<span><span class="va">newdata_batches</span> <span class="op">&lt;-</span> <span class="va">newdata</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="op">~</span> <span class="va">age_48</span><span class="op">:</span><span class="va">speaking_sps_3</span><span class="op">)</span></span></code></pre></div>
<p>Next I sample 1000 children from each draw. The 1000 childen are 1000
draws from the multivariate normal distribution used in the random
effects. First I extract the variance-covariance matrix of the random
effects. I use an <code>rvar()</code> which allows me to write code for
the 6000 x 5 x 5 array of posterior draws as if it were a 5 x 5 matrix.
The random effects are centered at 0 so each row of newdata is given a
mean of 0.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cov</span> <span class="op">&lt;-</span> <span class="va">model_rs_length</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/VarCorr.html" class="external-link">VarCorr</a></span><span class="op">(</span>summary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="va">_</span><span class="op">$</span><span class="va">child</span><span class="op">$</span><span class="va">cov</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/rvar.html" class="external-link">rvar</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">cov</span></span>
<span><span class="co">#&gt; rvar&lt;6000&gt;[5,5] mean ± sd:</span></span>
<span><span class="co">#&gt;              Intercept      tocs_length4   tocs_length5   tocs_length6  </span></span>
<span><span class="co">#&gt; Intercept     0.64 ± 0.071  -0.11 ± 0.054  -0.14 ± 0.055  -0.11 ± 0.056 </span></span>
<span><span class="co">#&gt; tocs_length4 -0.11 ± 0.054   0.26 ± 0.084   0.09 ± 0.051   0.13 ± 0.056 </span></span>
<span><span class="co">#&gt; tocs_length5 -0.14 ± 0.055   0.09 ± 0.051   0.16 ± 0.075   0.10 ± 0.052 </span></span>
<span><span class="co">#&gt; tocs_length6 -0.11 ± 0.056   0.13 ± 0.056   0.10 ± 0.052   0.20 ± 0.075 </span></span>
<span><span class="co">#&gt; tocs_length7 -0.12 ± 0.062   0.15 ± 0.060   0.10 ± 0.055   0.21 ± 0.070 </span></span>
<span><span class="co">#&gt;              tocs_length7  </span></span>
<span><span class="co">#&gt; Intercept    -0.12 ± 0.062 </span></span>
<span><span class="co">#&gt; tocs_length4  0.15 ± 0.060 </span></span>
<span><span class="co">#&gt; tocs_length5  0.10 ± 0.055 </span></span>
<span><span class="co">#&gt; tocs_length6  0.21 ± 0.070 </span></span>
<span><span class="co">#&gt; tocs_length7  0.30 ± 0.087</span></span>
<span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cov</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rows_batches</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">newdata_batches</span>, <span class="va">nrow</span>, <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">rows_batches</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">means</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">num_children</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">sim_children</span> <span class="op">&lt;-</span> <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/rdo.html" class="external-link">rdo</a></span><span class="op">(</span><span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">num_children</span>, <span class="va">means</span>, <span class="va">cov</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Given the simulated children, I walk through each batch of new data,
get the linear predictions (predictions in logits using just the fixed
effects), add the simulated children to each linear prediction, convert
the logits into proportions and then average over the 1000 children for
that draw.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l</span> <span class="op">&lt;-</span> <span class="va">newdata_batches</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu">tidybayes</span><span class="fu">::</span><span class="va">add_linpred_rvars</span>, <span class="va">model_rs_length</span>, re_formula <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">x</span><span class="op">$</span><span class="va">.marginal</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">sim_children</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">.linpred</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/inv_logit_scaled.html" class="external-link">inv_logit_scaled</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/rvar_apply.html" class="external-link">rvar_apply</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu">posterior</span><span class="fu">::</span><span class="va"><a href="https://mc-stan.org/posterior/reference/rvar-summaries-within-draws.html" class="external-link">rvar_mean</a></span><span class="op">)</span></span>
<span>      <span class="va">x</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This part is time-consuming so I load in the precomputed value.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">targets</span><span class="fu">::</span><span class="fu">tar_read</span><span class="op">(</span><span class="va">marginal_means_model_rs_length</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 50 × 6</span></span>
<span><span class="co">#&gt;    age_48 tocs_length speaking_sps_3 child        .linpred     .marginal</span></span>
<span><span class="co">#&gt;     &lt;dbl&gt; &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;      &lt;rvar[1d]&gt;    &lt;rvar[1d]&gt;</span></span>
<span><span class="co">#&gt;  1    -12 3                        0 fake    0.231 ± 0.080  0.55 ± 0.018</span></span>
<span><span class="co">#&gt;  2    -12 4                        0 fake    0.130 ± 0.080  0.53 ± 0.019</span></span>
<span><span class="co">#&gt;  3    -12 5                        0 fake   -0.078 ± 0.077  0.48 ± 0.019</span></span>
<span><span class="co">#&gt;  4    -12 6                        0 fake    0.061 ± 0.082  0.51 ± 0.020</span></span>
<span><span class="co">#&gt;  5    -12 7                        0 fake   -0.283 ± 0.084  0.43 ± 0.020</span></span>
<span><span class="co">#&gt;  6      0 3                        0 fake    1.448 ± 0.065  0.78 ± 0.011</span></span>
<span><span class="co">#&gt;  7      0 4                        0 fake    1.347 ± 0.063  0.78 ± 0.010</span></span>
<span><span class="co">#&gt;  8      0 5                        0 fake    1.138 ± 0.058  0.75 ± 0.011</span></span>
<span><span class="co">#&gt;  9      0 6                        0 fake    1.278 ± 0.064  0.77 ± 0.011</span></span>
<span><span class="co">#&gt; 10      0 7                        0 fake    0.933 ± 0.066  0.71 ± 0.013</span></span>
<span><span class="co">#&gt; # ℹ 40 more rows</span></span></code></pre></div>
<p>The <code>.marginal</code> column has 6000 marginal means for each
row of the prediction grid. Subtracting between two rows would give 6000
differences. Estimates and comparisons were computed by taking the
median and 95% quantile intervals of the means and differences.</p>
</div>
</div>
<div class="section level2">
<h2 id="logistic-regression-model">Logistic regression model<a class="anchor" aria-label="anchor" href="#logistic-regression-model"></a>
</h2>
<p>For the within-child effects of rate, we use the item-level data for
the 5-, 6-, and 7-word utterances.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_model_by_item_anon</span> <span class="op">&lt;-</span> <span class="fu">targets</span><span class="fu">::</span><span class="fu">tar_read</span><span class="op">(</span><span class="va">data_model_by_item_anon</span><span class="op">)</span></span>
<span><span class="va">data_model_by_item_anon</span></span>
<span><span class="co">#&gt; # A tibble: 11,282 × 18</span></span>
<span><span class="co">#&gt;    child item  speaking_sps artic_sps age_months tocs_level length_longest</span></span>
<span><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 c130  S5T01         2.47      2.47         34          5              5</span></span>
<span><span class="co">#&gt;  2 c130  S5T02         2.26      2.26         34          5              5</span></span>
<span><span class="co">#&gt;  3 c130  S5T03         2.55      2.55         34          5              5</span></span>
<span><span class="co">#&gt;  4 c130  S5T04         2.77      2.77         34          5              5</span></span>
<span><span class="co">#&gt;  5 c130  S5T05         3.01      3.01         34          5              5</span></span>
<span><span class="co">#&gt;  6 c130  S5T06         1.89      2.12         34          5              5</span></span>
<span><span class="co">#&gt;  7 c130  S5T07         2.39      2.39         34          5              5</span></span>
<span><span class="co">#&gt;  8 c130  S5T08         2.20      2.50         34          5              5</span></span>
<span><span class="co">#&gt;  9 c130  S5T09         2.83      2.83         34          5              5</span></span>
<span><span class="co">#&gt; 10 c227  S5T01         3         3            35          5              5</span></span>
<span><span class="co">#&gt; # ℹ 11,272 more rows</span></span>
<span><span class="co">#&gt; # ℹ 11 more variables: age_bin &lt;dbl&gt;, intelligibility &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   n_words_correct &lt;dbl&gt;, n_words_total &lt;dbl&gt;, mwi &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   speaking_sps_3 &lt;dbl&gt;, artic_sps_3 &lt;dbl&gt;, age_48 &lt;dbl&gt;, tocs_length &lt;fct&gt;,</span></span>
<span><span class="co">#&gt; #   tocs_level_3 &lt;dbl&gt;, child_mean_rate &lt;dbl&gt;</span></span></code></pre></div>
<p>New here are</p>
<ul>
<li>
<code>item</code>: item identifier</li>
<li>
<code>n_words_correct</code>, <code>n_words_total</code>: number of
words correctly transcribed by the listeners and number of words total,
so the intelligibility is the proportion of words correctly
transcribed</li>
<li>
<code>child_mean_rate</code>: a child’s average speaking rate over
all items</li>
</ul>
<p>The fitted model was the following:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_logistic</span> <span class="op">&lt;-</span> <span class="fu">targets</span><span class="fu">::</span><span class="fu">tar_read</span><span class="op">(</span></span>
<span>  <span class="st">"model_rs_rate_ri_item_no_length_binom_mundlak"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">model_logistic</span></span>
<span><span class="co">#&gt;  Family: binomial </span></span>
<span><span class="co">#&gt;   Links: mu = logit </span></span>
<span><span class="co">#&gt; Formula: n_words_correct | trials(n_words_total) ~ ns(age_48, knots = c(9, 25), Boundary.knots = c(-18, 71)) + speaking_sps_3 + child_mean_rate + (speaking_sps_3 | child) + (1 | item) </span></span>
<span><span class="co">#&gt;    Data: data (Number of observations: 11282) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 3000; warmup = 1500; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 6000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multilevel Hyperparameters:</span></span>
<span><span class="co">#&gt; ~child (Number of levels: 422) </span></span>
<span><span class="co">#&gt;                               Estimate Est.Error l-95% CI u-95% CI Rhat</span></span>
<span><span class="co">#&gt; sd(Intercept)                     0.85      0.03     0.78     0.92 1.00</span></span>
<span><span class="co">#&gt; sd(speaking_sps_3)                0.50      0.03     0.44     0.56 1.00</span></span>
<span><span class="co">#&gt; cor(Intercept,speaking_sps_3)    -0.15      0.07    -0.28    -0.01 1.00</span></span>
<span><span class="co">#&gt;                               Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; sd(Intercept)                     1367     2649</span></span>
<span><span class="co">#&gt; sd(speaking_sps_3)                2518     3793</span></span>
<span><span class="co">#&gt; cor(Intercept,speaking_sps_3)     1917     2597</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ~item (Number of levels: 29) </span></span>
<span><span class="co">#&gt;               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; sd(Intercept)     0.71      0.09     0.55     0.92 1.00     1108     2461</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;                                            Estimate Est.Error l-95% CI u-95% CI</span></span>
<span><span class="co">#&gt; Intercept                                      0.49      0.33    -0.16     1.14</span></span>
<span><span class="co">#&gt; nsage_48knotsEQc925Boundary.knotsEQcM18711     2.93      0.20     2.52     3.33</span></span>
<span><span class="co">#&gt; nsage_48knotsEQc925Boundary.knotsEQcM18712     4.72      0.66     3.42     6.02</span></span>
<span><span class="co">#&gt; nsage_48knotsEQc925Boundary.knotsEQcM18713     3.30      0.27     2.74     3.83</span></span>
<span><span class="co">#&gt; speaking_sps_3                                -0.23      0.04    -0.30    -0.16</span></span>
<span><span class="co">#&gt; child_mean_rate                               -0.12      0.15    -0.42     0.17</span></span>
<span><span class="co">#&gt;                                            Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept                                  1.00      879     1846</span></span>
<span><span class="co">#&gt; nsage_48knotsEQc925Boundary.knotsEQcM18711 1.00     1064     1742</span></span>
<span><span class="co">#&gt; nsage_48knotsEQc925Boundary.knotsEQcM18712 1.00     1098     1950</span></span>
<span><span class="co">#&gt; nsage_48knotsEQc925Boundary.knotsEQcM18713 1.00     1810     2818</span></span>
<span><span class="co">#&gt; speaking_sps_3                             1.00     4260     4387</span></span>
<span><span class="co">#&gt; child_mean_rate                            1.00     1031     2004</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
<p>The random effects include a by-child random intercept, by-child rate
effects, and by-item intercepts. The same age-spline is used as before
for the fixed effects. The other two predictors are the speaking rate on
the given utterance and the child’s average speaking rate. The
<code>child_mean_rate</code> is meant to absorb child-level reflect a
child’s habitual rate so that the <code>speaking_sps_3</code> can
estimate the within child effects of rate.</p>
<p>We can extract the posterior means of each child’s rate coefficient
like so:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Posterior draws of the slopes</span></span>
<span><span class="va">child_slopes</span> <span class="op">&lt;-</span> <span class="va">model_logistic</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span>summary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Extract.html" class="external-link">getElement</a></span><span class="op">(</span><span class="st">"child"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="va">_</span><span class="op">[</span>, , <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"speaking_sps_3"</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/rvar.html" class="external-link">rvar</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">slope_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">child_slopes</span><span class="op">)</span><span class="op">[</span>, <span class="st">"speaking_sps_3"</span><span class="op">]</span></span>
<span></span>
<span><span class="va">f_percent</span> <span class="op">&lt;-</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html" class="external-link">label_percent</a></span><span class="op">(</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="va">lslopes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  n_positive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">slope_means</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  n_negative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">slope_means</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  pct_positive <span class="op">=</span> <span class="fu">f_percent</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">slope_means</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">slope_means</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  pct_negative <span class="op">=</span> <span class="fu">f_percent</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">slope_means</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">slope_means</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">lslopes</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ n_positive  : int 107</span></span>
<span><span class="co">#&gt;  $ n_negative  : int 315</span></span>
<span><span class="co">#&gt;  $ pct_positive: chr "25.4%"</span></span>
<span><span class="co">#&gt;  $ pct_negative: chr "74.6%"</span></span></code></pre></div>
<p>The plotted lines used <code>tidybayes::add_epred_rvars()</code> to
get child-level predictions when <code>trials</code> is set to 1. We
take a grid of 50 points along each child’s observed speaking rate, get
posterior expectations for each of those point and plot the mean of
those expectations for each child.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_binom_rate_grid</span> <span class="op">&lt;-</span> <span class="va">data_model_by_item_anon</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">child</span>, <span class="va">age_months</span>, <span class="va">age_bin</span>, <span class="va">age_48</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe</a></span><span class="op">(</span></span>
<span>    child_mean_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">speaking_sps_3</span><span class="op">)</span>,</span>
<span>    speaking_sps_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">speaking_sps_3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">speaking_sps_3</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>      <span class="va">child_mean_rate</span></span>
<span>    <span class="op">)</span>,</span>
<span>    item <span class="op">=</span> <span class="st">"fake"</span>,</span>
<span>    n_words_total <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">data_binom_rate_grid</span> <span class="op">&lt;-</span> <span class="fu">tidybayes</span><span class="fu">::</span><span class="fu">add_epred_rvars</span><span class="op">(</span></span>
<span>  <span class="va">data_binom_rate_grid</span>,</span>
<span>  <span class="va">model_logistic</span>,</span>
<span>  allow_new_levels <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Bürkner, P.-C. (2017). brms: An R package for Bayesian multilevel
models using Stan. <em>Journal of Statistical Software</em>,
<em>80</em>(1), 1–28. <a href="doi:%5B10.18637/jss.v080.i01" class="uri">doi:[10.18637/jss.v080.i01</a>](<a href="https://doi.org/10.18637/jss.v080.i01" class="external-link uri">https://doi.org/10.18637/jss.v080.i01</a>)</p>
<p>Bürkner, P.-C., &amp; Charpentier, E. (2020). Modelling monotonic
effects of ordinal predictors in Bayesian regression models. <em>British
Journal of Mathematical and Statistical Psychology</em>, <em>73</em>(3),
420–451. <a href="doi:%5B10.1111/bmsp.12195" class="uri">doi:[10.1111/bmsp.12195</a>](<a href="https://doi.org/10.1111/bmsp.12195" class="external-link uri">https://doi.org/10.1111/bmsp.12195</a>)</p>
<p>Gabry, J., Češnovar, R., &amp; Johnson, A. (2024). <em>cmdstanr: R
interface to CmdStan</em>. Retrieved from <a href="https://mc-stan.org/cmdstanr/" class="external-link uri">https://mc-stan.org/cmdstanr/</a></p>
<p>R Core Team. (2024). <em>R: A language and environment for
statistical computing</em>. Vienna, Austria: R Foundation for
Statistical Computing. Retrieved from <a href="https://www.R-project.org/" class="external-link uri">https://www.R-project.org/</a></p>
<p>Stan Development Team. (2024). <em>Stan modeling language users guide
and reference manual</em>. Retrieved from <a href="https://mc-stan.org" class="external-link uri">https://mc-stan.org</a></p>
<p>Vehtari, A., Gelman, A., &amp; Gabry, J. (2017). Practical Bayesian
model evaluation using leave-one-out cross-validation and WAIC.
<em>Statistics and Computing</em>, <em>27</em>, 1413–1432. <a href="doi:%5B10.1007/s11222-016-9696-4" class="uri">doi:[10.1007/s11222-016-9696-4</a>](<a href="https://doi.org/10.1007/s11222-016-9696-4" class="external-link uri">https://doi.org/10.1007/s11222-016-9696-4</a>)</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tristan Mahr.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
